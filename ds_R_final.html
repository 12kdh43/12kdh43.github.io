<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
	
	<!-- On Post front-matter YAML, set "use_math: true" to use LaTex -->
	

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Data Science and R - Final</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- syntax.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
	
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="" />
    <link rel="shortcut icon" href="http://0.0.0.0:4000/assets/built/images/favicon.jpg" type="image/png" />
    <link rel="canonical" href="http://0.0.0.0:4000/ds_R_final" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Darron's Devlog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Data Science and R - Final" />
    <meta property="og:description" content="1. About 2. Load Data and Preprocess 2.1. Set Attributes 2.2. Handling NA values 3. EDA 3.1. 통합대기환경지수(Comprehensive air-quality index), CAI 계산 3.2. Timestep-wise Visualization 3.2.1. Hourly 3.2.2. Daily 3.2.3. Montly 3.2.4. Quarterly 3.2.5. Half-yearly 4. Summary 1. About 2020-2, Data Science and R, Final Proejct: 대기환경오염도 데이터 분석 2." />
    <meta property="og:url" content="http://0.0.0.0:4000/ds_R_final" />
    <meta property="og:image" content="http://0.0.0.0:4000/assets/built/images/blog-cover1.png" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2020-12-16T00:00:00+09:00" />
    <meta property="article:modified_time" content="2020-12-16T00:00:00+09:00" />
    <meta property="article:tag" content="projects" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Data Science and R - Final" />
    <meta name="twitter:description" content="1. About 2. Load Data and Preprocess 2.1. Set Attributes 2.2. Handling NA values 3. EDA 3.1. 통합대기환경지수(Comprehensive air-quality index), CAI 계산 3.2. Timestep-wise Visualization 3.2.1. Hourly 3.2.2. Daily 3.2.3. Montly 3.2.4. Quarterly 3.2.5. Half-yearly 4. Summary 1. About 2020-2, Data Science and R, Final Proejct: 대기환경오염도 데이터 분석 2." />
    <meta name="twitter:url" content="http://0.0.0.0:4000/" />
    <meta name="twitter:image" content="http://0.0.0.0:4000/assets/built/images/blog-cover1.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Darron's Devlog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="projects" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Darron's Devlog",
        "logo": "http://0.0.0.0:4000/"
    },
    "url": "http://0.0.0.0:4000/ds_R_final",
    "image": {
        "@type": "ImageObject",
        "url": "http://0.0.0.0:4000/assets/built/images/blog-cover1.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://0.0.0.0:4000/ds_R_final"
    },
    "description": "1. About 2. Load Data and Preprocess 2.1. Set Attributes 2.2. Handling NA values 3. EDA 3.1. 통합대기환경지수(Comprehensive air-quality index), CAI 계산 3.2. Timestep-wise Visualization 3.2.1. Hourly 3.2.2. Daily 3.2.3. Montly 3.2.4. Quarterly 3.2.5. Half-yearly 4. Summary 1. About 2020-2, Data Science and R, Final Proejct: 대기환경오염도 데이터 분석 2."
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Data Science and R - Final" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="/">Darron's Devlog</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-projects" role="menuitem"><a href="/tag/projects/">Projects</a></li>
    <li class="nav-studies" role="menuitem"><a href="/tag/studies/">Studies</a></li>
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
</ul>
        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-projects  no-image">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="16 December 2020">16 December 2020</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/projects/'>PROJECTS</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">Data Science and R - Final</h1>
            </header>
	<!--
            
	-->
            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <ul id="markdown-toc">
  <li><a href="#1-about" id="markdown-toc-1-about">1. About</a></li>
  <li><a href="#2-load-data-and-preprocess" id="markdown-toc-2-load-data-and-preprocess">2. Load Data and Preprocess</a>    <ul>
      <li><a href="#21-set-attributes" id="markdown-toc-21-set-attributes">2.1. Set Attributes</a></li>
      <li><a href="#22-handling-na-values" id="markdown-toc-22-handling-na-values">2.2. Handling NA values</a></li>
    </ul>
  </li>
  <li><a href="#3-eda" id="markdown-toc-3-eda">3. EDA</a>    <ul>
      <li><a href="#31-통합대기환경지수comprehensive-air-quality-index-cai-계산" id="markdown-toc-31-통합대기환경지수comprehensive-air-quality-index-cai-계산">3.1. 통합대기환경지수(Comprehensive air-quality index), CAI 계산</a></li>
      <li><a href="#32-timestep-wise-visualization" id="markdown-toc-32-timestep-wise-visualization">3.2. Timestep-wise Visualization</a>        <ul>
          <li><a href="#321-hourly" id="markdown-toc-321-hourly">3.2.1. Hourly</a></li>
          <li><a href="#322-daily" id="markdown-toc-322-daily">3.2.2. Daily</a></li>
          <li><a href="#323-montly" id="markdown-toc-323-montly">3.2.3. Montly</a></li>
          <li><a href="#324-quarterly" id="markdown-toc-324-quarterly">3.2.4. Quarterly</a></li>
          <li><a href="#325-half-yearly" id="markdown-toc-325-half-yearly">3.2.5. Half-yearly</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#4-summary" id="markdown-toc-4-summary">4. Summary</a></li>
</ul>

<h1 id="1-about">1. About</h1>
<ul>
  <li>2020-2, Data Science and R, Final Proejct: 대기환경오염도 데이터 분석</li>
</ul>

<h1 id="2-load-data-and-preprocess">2. Load Data and Preprocess</h1>
<ul>
  <li>Collected data from Air Korea (https://www.airkorea.or.kr)</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">vcd</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">read_xlsx</span><span class="p">(</span><span class="s2">"./final_data/data.xlsx"</span><span class="p">);</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="w">
</span><span class="n">nrow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-python highlighter-rouge">
	<table>
	<thead><tr><th scope="col">날짜</th><th scope="col">시도</th><th scope="col">측정소명</th><th scope="col">측정소코드</th><th scope="col">아황산가스</th><th scope="col">일산화탄소</th><th scope="col">오존</th><th scope="col">이산화질소</th><th scope="col">PM10</th><th scope="col">PM2.5</th></tr></thead>
	<tbody>
		<tr><td>2017-07-01 01</td><td>인천 옹진군  </td><td>백령도       </td><td>831492       </td><td>.0016        </td><td>.3           </td><td>.052         </td><td>.0016        </td><td>44           </td><td>35           </td></tr>
		<tr><td>2017-07-01 02</td><td>인천 옹진군  </td><td>백령도       </td><td>831492       </td><td>.0016        </td><td>.3           </td><td>.052         </td><td>.0017        </td><td>21           </td><td>NA           </td></tr>
		<tr><td>2017-07-01 03</td><td>인천 옹진군  </td><td>백령도       </td><td>831492       </td><td>.0017        </td><td>.3           </td><td>.051         </td><td>.0017        </td><td>32           </td><td>18           </td></tr>
		<tr><td>2017-07-01 04</td><td>인천 옹진군  </td><td>백령도       </td><td>831492       </td><td>.0017        </td><td>.3           </td><td>.05          </td><td>.002         </td><td>10           </td><td>NA           </td></tr>
		<tr><td>2017-07-01 05</td><td>인천 옹진군  </td><td>백령도       </td><td>831492       </td><td>.0016        </td><td>.3           </td><td>.048         </td><td>.0018        </td><td>24           </td><td>22           </td></tr>
	</tbody>
	</table>
</div>

<p>26304</p>

<h2 id="21-set-attributes">2.1. Set Attributes</h2>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#   시도, 측정소명, 측정소코드는 모두 같으므로 제외</span><span class="w">
</span><span class="c1">#   날짜는 시구간별 분석을 위해 연, 월, 일, 시로 분리: int타입으로 반환됨</span><span class="w">
</span><span class="c1">#   측정 대상 오염 물질의 자료형 변환</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="n">시도</span><span class="p">,</span><span class="n">측정소명</span><span class="p">,</span><span class="n">측정소코드</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">separate</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="n">날짜</span><span class="p">,</span><span class="w">
           </span><span class="n">into</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"year"</span><span class="p">,</span><span class="s2">"month"</span><span class="p">,</span><span class="s2">"day"</span><span class="p">,</span><span class="s2">"hour"</span><span class="p">),</span><span class="w">
           </span><span class="n">convert</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate_if</span><span class="p">(</span><span class="n">is.character</span><span class="p">,</span><span class="n">as.numeric</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rename</span><span class="p">(</span><span class="n">SO2</span><span class="o">=</span><span class="n">아황산가스</span><span class="p">,</span><span class="n">CO</span><span class="o">=</span><span class="n">일산화탄소</span><span class="p">,</span><span class="n">O3</span><span class="o">=</span><span class="n">오존</span><span class="p">,</span><span class="n">NO2</span><span class="o">=</span><span class="n">이산화질소</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="m">5</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-python highlighter-rouge">
	<table>
	<thead><tr><th scope="col">year</th><th scope="col">month</th><th scope="col">day</th><th scope="col">hour</th><th scope="col">SO2</th><th scope="col">CO</th><th scope="col">O3</th><th scope="col">NO2</th><th scope="col">PM10</th><th scope="col">PM2.5</th></tr></thead>
	<tbody>
		<tr><td>2017  </td><td>7     </td><td>1     </td><td>1     </td><td>0.0016</td><td>0.3   </td><td>0.052 </td><td>0.0016</td><td>44    </td><td>35    </td></tr>
		<tr><td>2017  </td><td>7     </td><td>1     </td><td>2     </td><td>0.0016</td><td>0.3   </td><td>0.052 </td><td>0.0017</td><td>21    </td><td>NA    </td></tr>
		<tr><td>2017  </td><td>7     </td><td>1     </td><td>3     </td><td>0.0017</td><td>0.3   </td><td>0.051 </td><td>0.0017</td><td>32    </td><td>18    </td></tr>
		<tr><td>2017  </td><td>7     </td><td>1     </td><td>4     </td><td>0.0017</td><td>0.3   </td><td>0.050 </td><td>0.0020</td><td>10    </td><td>NA    </td></tr>
		<tr><td>2017  </td><td>7     </td><td>1     </td><td>5     </td><td>0.0016</td><td>0.3   </td><td>0.048 </td><td>0.0018</td><td>24    </td><td>22    </td></tr>
	</tbody>
	</table>
</div>

<h2 id="22-handling-na-values">2.2. Handling NA values</h2>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 일평균 값을 확인</span><span class="w">
</span><span class="n">daily</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">,</span><span class="n">day</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select_if</span><span class="p">(</span><span class="n">is.double</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise_all</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">daily</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      year          month             day             SO2           
 Min.   :2017   Min.   : 1.000   Min.   : 1.00   Min.   :0.0001765  
 1st Qu.:2018   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.:0.0012553  
 Median :2018   Median : 7.000   Median :16.00   Median :0.0017042  
 Mean   :2018   Mean   : 6.522   Mean   :15.73   Mean   :0.0018339  
 3rd Qu.:2019   3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:0.0022417  
 Max.   :2020   Max.   :12.000   Max.   :31.00   Max.   :0.0078375  
                                                 NA's   :1          
       CO                O3               NO2                PM10       
 Min.   :0.04583   Min.   :0.01188   Min.   :0.000850   Min.   :  2.00  
 1st Qu.:0.23750   1st Qu.:0.03453   1st Qu.:0.002373   1st Qu.: 20.88  
 Median :0.32917   Median :0.04290   Median :0.003296   Median : 29.25  
 Mean   :0.37287   Mean   :0.04405   Mean   :0.003853   Mean   : 35.58  
 3rd Qu.:0.46667   3rd Qu.:0.05192   3rd Qu.:0.004764   3rd Qu.: 42.54  
 Max.   :1.39167   Max.   :0.09971   Max.   :0.020209   Max.   :217.04  
 NA's   :2                                              NA's   :5       
     PM2.5        
 Min.   :  1.826  
 1st Qu.: 10.042  
 Median : 14.625  
 Mean   : 18.736  
 3rd Qu.: 22.375  
 Max.   :126.375  
 NA's   :23       
</code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># NA: 하루 전체 관측치가 NA인 경우에 발생</span><span class="w">
</span><span class="c1"># 월평균 값을 확인</span><span class="w">
</span><span class="n">monthly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select_if</span><span class="p">(</span><span class="n">is.double</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise_all</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">monthly</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      year          month            SO2                 CO        
 Min.   :2017   Min.   : 1.00   Min.   :0.001099   Min.   :0.1911  
 1st Qu.:2018   1st Qu.: 3.75   1st Qu.:0.001394   1st Qu.:0.2646  
 Median :2018   Median : 6.50   Median :0.001789   Median :0.3562  
 Mean   :2018   Mean   : 6.50   Mean   :0.001832   Mean   :0.3730  
 3rd Qu.:2019   3rd Qu.: 9.25   3rd Qu.:0.002084   3rd Qu.:0.4491  
 Max.   :2020   Max.   :12.00   Max.   :0.003140   Max.   :0.7588  
       O3               NO2                PM10           PM2.5      
 Min.   :0.02447   Min.   :0.001857   Min.   :20.24   Min.   :10.62  
 1st Qu.:0.03821   1st Qu.:0.002876   1st Qu.:27.31   1st Qu.:13.94  
 Median :0.04175   Median :0.004066   Median :35.42   Median :18.41  
 Mean   :0.04410   Mean   :0.003850   Mean   :35.69   Mean   :18.92  
 3rd Qu.:0.05154   3rd Qu.:0.004658   3rd Qu.:42.46   3rd Qu.:22.84  
 Max.   :0.06422   Max.   :0.005683   Max.   :58.00   Max.   :36.51  
</code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># NA값들을 일평균 또는 월평균 값으로 대체</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">data</span><span class="p">))){</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"SO2"</span><span class="p">,</span><span class="s2">"CO"</span><span class="p">,</span><span class="s2">"O3"</span><span class="p">,</span><span class="s2">"NO2"</span><span class="p">,</span><span class="s2">"PM10"</span><span class="p">,</span><span class="s2">"PM2.5"</span><span class="p">)){</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,][[</span><span class="n">j</span><span class="p">]])){</span><span class="w">
      </span><span class="n">tmp</span><span class="o">&lt;-</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,]</span><span class="w">
      </span><span class="n">y</span><span class="o">&lt;-</span><span class="n">tmp</span><span class="o">$</span><span class="n">year</span><span class="w">
      </span><span class="n">m</span><span class="o">&lt;-</span><span class="n">tmp</span><span class="o">$</span><span class="n">month</span><span class="w">
      </span><span class="n">d</span><span class="o">&lt;-</span><span class="n">tmp</span><span class="o">$</span><span class="n">day</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.nan</span><span class="p">(</span><span class="n">daily</span><span class="p">[</span><span class="n">daily</span><span class="o">$</span><span class="n">year</span><span class="o">==</span><span class="n">y</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">daily</span><span class="o">$</span><span class="n">month</span><span class="o">==</span><span class="n">m</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">daily</span><span class="o">$</span><span class="n">day</span><span class="o">==</span><span class="n">d</span><span class="p">,][[</span><span class="n">j</span><span class="p">]])){</span><span class="w">
        </span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,][[</span><span class="n">j</span><span class="p">]]</span><span class="o">&lt;-</span><span class="n">daily</span><span class="p">[</span><span class="n">daily</span><span class="o">$</span><span class="n">year</span><span class="o">==</span><span class="n">y</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">daily</span><span class="o">$</span><span class="n">month</span><span class="o">==</span><span class="n">m</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">daily</span><span class="o">$</span><span class="n">day</span><span class="o">==</span><span class="n">d</span><span class="p">,][[</span><span class="n">j</span><span class="p">]]</span><span class="w">
      </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
        </span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,][[</span><span class="n">j</span><span class="p">]]</span><span class="o">&lt;-</span><span class="n">monthly</span><span class="p">[</span><span class="n">monthly</span><span class="o">$</span><span class="n">year</span><span class="o">==</span><span class="n">y</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">monthly</span><span class="o">$</span><span class="n">month</span><span class="o">==</span><span class="n">m</span><span class="p">,][[</span><span class="n">j</span><span class="p">]]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      year          month             day             hour      
 Min.   :2017   Min.   : 1.000   Min.   : 1.00   Min.   : 1.00  
 1st Qu.:2018   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.: 6.75  
 Median :2018   Median : 7.000   Median :16.00   Median :12.50  
 Mean   :2018   Mean   : 6.522   Mean   :15.73   Mean   :12.50  
 3rd Qu.:2019   3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:18.25  
 Max.   :2020   Max.   :12.000   Max.   :31.00   Max.   :24.00  
      SO2                 CO               O3               NO2          
 Min.   :0.000000   Min.   :0.0000   Min.   :0.00100   Min.   :0.000300  
 1st Qu.:0.001200   1st Qu.:0.2000   1st Qu.:0.03400   1st Qu.:0.002100  
 Median :0.001700   Median :0.3000   Median :0.04300   Median :0.003000  
 Mean   :0.001834   Mean   :0.3726   Mean   :0.04405   Mean   :0.003853  
 3rd Qu.:0.002300   3rd Qu.:0.5000   3rd Qu.:0.05200   3rd Qu.:0.004600  
 Max.   :0.034700   Max.   :2.5000   Max.   :0.13200   Max.   :0.045900  
      PM10            PM2.5       
 Min.   :  1.00   Min.   :  0.00  
 1st Qu.: 19.00   1st Qu.:  9.00  
 Median : 28.00   Median : 14.00  
 Mean   : 35.57   Mean   : 18.78  
 3rd Qu.: 43.00   3rd Qu.: 22.77  
 Max.   :461.00   Max.   :219.00  
</code></pre></div></div>

<h1 id="3-eda">3. EDA</h1>

<h2 id="31-통합대기환경지수comprehensive-air-quality-index-cai-계산">3.1. 통합대기환경지수(Comprehensive air-quality index), CAI 계산</h2>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### 통합대기환경지수CAI 지수를 계산</span><span class="w">
</span><span class="c1"># 항목별 계산 함수를 정의</span><span class="w">
</span><span class="n">SO2_I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">C_p</span><span class="p">){</span><span class="w">
  </span><span class="n">cut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.02</span><span class="p">,</span><span class="m">0.05</span><span class="p">,</span><span class="m">0.15</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="kc">Inf</span><span class="p">)</span><span class="w">
  </span><span class="n">BP_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.02</span><span class="p">,</span><span class="m">0.02</span><span class="p">,</span><span class="m">0.05</span><span class="p">,</span><span class="m">0.15</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))))</span><span class="w">
  </span><span class="n">BP_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.021</span><span class="p">,</span><span class="m">0.051</span><span class="p">,</span><span class="m">0.151</span><span class="p">,</span><span class="m">0.151</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">250</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="m">500</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">51</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">251</span><span class="p">,</span><span class="m">251</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(((</span><span class="n">I_hi</span><span class="o">-</span><span class="n">I_lo</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BP_hi</span><span class="o">-</span><span class="n">BP_lo</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">C_p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BP_lo</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I_lo</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">I_p</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">CO_I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">C_p</span><span class="p">){</span><span class="w">
  </span><span class="n">cut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="kc">Inf</span><span class="p">)</span><span class="w">
  </span><span class="n">BP_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">50</span><span class="p">))))</span><span class="w">
  </span><span class="n">BP_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">2.01</span><span class="p">,</span><span class="m">9.01</span><span class="p">,</span><span class="m">15.01</span><span class="p">,</span><span class="m">15.01</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">250</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="m">500</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">51</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">251</span><span class="p">,</span><span class="m">251</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">I_hi</span><span class="o">-</span><span class="n">I_lo</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BP_hi</span><span class="o">-</span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">C_p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I_lo</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">I_p</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">O3_I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">C_p</span><span class="p">){</span><span class="w">
  </span><span class="n">cut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.03</span><span class="p">,</span><span class="m">0.09</span><span class="p">,</span><span class="m">0.15</span><span class="p">,</span><span class="m">0.6</span><span class="p">,</span><span class="kc">Inf</span><span class="p">)</span><span class="w">
  </span><span class="n">BP_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.03</span><span class="p">,</span><span class="m">0.03</span><span class="p">,</span><span class="m">0.09</span><span class="p">,</span><span class="m">0.15</span><span class="p">,</span><span class="m">0.6</span><span class="p">,</span><span class="m">0.6</span><span class="p">))))</span><span class="w">
  </span><span class="n">BP_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.031</span><span class="p">,</span><span class="m">0.091</span><span class="p">,</span><span class="m">0.151</span><span class="p">,</span><span class="m">0.151</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">250</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="m">500</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">51</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">251</span><span class="p">,</span><span class="m">251</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">I_hi</span><span class="o">-</span><span class="n">I_lo</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BP_hi</span><span class="o">-</span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">C_p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I_lo</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">I_p</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">NO2_I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">C_p</span><span class="p">){</span><span class="w">
  </span><span class="n">cut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.03</span><span class="p">,</span><span class="m">0.06</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="kc">Inf</span><span class="p">)</span><span class="w">
  </span><span class="n">BP_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.03</span><span class="p">,</span><span class="m">0.03</span><span class="p">,</span><span class="m">0.06</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))))</span><span class="w">
  </span><span class="n">BP_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.031</span><span class="p">,</span><span class="m">0.061</span><span class="p">,</span><span class="m">0.201</span><span class="p">,</span><span class="m">0.201</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">250</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="m">500</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">51</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">251</span><span class="p">,</span><span class="m">251</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">I_hi</span><span class="o">-</span><span class="n">I_lo</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BP_hi</span><span class="o">-</span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">C_p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I_lo</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">I_p</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># PM10, PM2.5의 이동평균을 구하기 위한 함수 정의</span><span class="w">
</span><span class="n">C12_cal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">PM</span><span class="p">){</span><span class="w">
  </span><span class="n">C12</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">PM</span><span class="p">))){</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="m">12</span><span class="p">){</span><span class="w">
      </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">PM</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">i</span><span class="w">
    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
      </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">PM</span><span class="p">[(</span><span class="n">i</span><span class="m">-11</span><span class="p">)</span><span class="o">:</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="m">12</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">C12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tmp</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="n">C12</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">C_ai_cal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">C_i</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">C12</span><span class="p">){</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">C_i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">M</span><span class="p">){</span><span class="w">
    </span><span class="n">C_ai</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">C_i</span><span class="w">
  </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="m">0.9</span><span class="o">&lt;=</span><span class="w"> </span><span class="p">(</span><span class="n">C_i</span><span class="o">/</span><span class="n">C12</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">C_i</span><span class="o">/</span><span class="n">C12</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="m">1.7</span><span class="p">){</span><span class="w">
    </span><span class="n">C_ai</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.75</span><span class="o">*</span><span class="n">C_i</span><span class="w">  
  </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">C_ai</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">C_i</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="n">C_ai</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="n">PM_cal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">PM</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">PM_C12</span><span class="p">){</span><span class="w">
  </span><span class="n">M</span><span class="o">=</span><span class="n">m</span><span class="w">
  </span><span class="n">C24E</span><span class="o">=</span><span class="nf">c</span><span class="p">()</span><span class="w">
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">PM</span><span class="p">))){</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="m">4</span><span class="p">){</span><span class="w">
      </span><span class="n">C4</span><span class="w"> </span><span class="o">&lt;</span><span class="m">-0</span><span class="w">
      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">:</span><span class="m">1</span><span class="p">)){</span><span class="w">
        </span><span class="n">C4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">C4</span><span class="o">+</span><span class="w"> </span><span class="n">C_ai_cal</span><span class="p">(</span><span class="n">PM</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">M</span><span class="p">,</span><span class="n">PM_C12</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w">
      </span><span class="p">}</span><span class="w">
      </span><span class="n">C4</span><span class="o">/</span><span class="n">i</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="p">{</span><span class="w">
      </span><span class="n">C4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">C_ai_cal</span><span class="p">(</span><span class="n">PM</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">M</span><span class="p">,</span><span class="n">PM_C12</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">C_ai_cal</span><span class="p">(</span><span class="n">PM</span><span class="p">[</span><span class="n">i</span><span class="m">-1</span><span class="p">],</span><span class="n">M</span><span class="p">,</span><span class="n">PM_C12</span><span class="p">[</span><span class="n">i</span><span class="m">-1</span><span class="p">]),</span><span class="w">
              </span><span class="n">C_ai_cal</span><span class="p">(</span><span class="n">PM</span><span class="p">[</span><span class="n">i</span><span class="m">-2</span><span class="p">],</span><span class="n">M</span><span class="p">,</span><span class="n">PM_C12</span><span class="p">[</span><span class="n">i</span><span class="m">-2</span><span class="p">]),</span><span class="n">C_ai_cal</span><span class="p">(</span><span class="n">PM</span><span class="p">[</span><span class="n">i</span><span class="m">-3</span><span class="p">],</span><span class="n">M</span><span class="p">,</span><span class="n">PM_C12</span><span class="p">[</span><span class="n">i</span><span class="m">-3</span><span class="p">]))</span><span class="o">/</span><span class="m">4</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">C12</span><span class="o">&lt;-</span><span class="n">PM_C12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="n">C24E</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">C12</span><span class="o">*</span><span class="m">12</span><span class="o">+</span><span class="n">C4</span><span class="o">*</span><span class="m">12</span><span class="p">)</span><span class="o">/</span><span class="m">24</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="n">C24E</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">PM10_I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">C_p</span><span class="p">){</span><span class="w">
  </span><span class="n">cut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">80</span><span class="p">,</span><span class="m">150</span><span class="p">,</span><span class="m">600</span><span class="p">,</span><span class="kc">Inf</span><span class="p">)</span><span class="w">
  </span><span class="n">BP_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
                                       </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">30</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">80</span><span class="p">,</span><span class="m">150</span><span class="p">,</span><span class="m">600</span><span class="p">,</span><span class="m">600</span><span class="p">))))</span><span class="w">
  </span><span class="n">BP_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
                                       </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">31</span><span class="p">,</span><span class="m">81</span><span class="p">,</span><span class="m">151</span><span class="p">,</span><span class="m">151</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
                                      </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">250</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="m">500</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w">
                                      </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">51</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">251</span><span class="p">,</span><span class="m">251</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">I_hi</span><span class="o">-</span><span class="n">I_lo</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BP_hi</span><span class="o">-</span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">C_p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I_lo</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">I_p</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">PM2.5_I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">C_p</span><span class="p">){</span><span class="w">
  </span><span class="n">cut</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="o">-</span><span class="kc">Inf</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">35</span><span class="p">,</span><span class="m">75</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="kc">Inf</span><span class="p">)</span><span class="w">
  </span><span class="n">BP_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">35</span><span class="p">,</span><span class="m">75</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="m">500</span><span class="p">))))</span><span class="w">
  </span><span class="n">BP_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">36</span><span class="p">,</span><span class="m">76</span><span class="p">,</span><span class="m">76</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_hi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">50</span><span class="p">,</span><span class="m">50</span><span class="p">,</span><span class="m">100</span><span class="p">,</span><span class="m">250</span><span class="p">,</span><span class="m">500</span><span class="p">,</span><span class="m">500</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_lo</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">cut</span><span class="p">(</span><span class="n">C_p</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="o">=</span><span class="n">cut</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">
                </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">51</span><span class="p">,</span><span class="m">101</span><span class="p">,</span><span class="m">251</span><span class="p">,</span><span class="m">251</span><span class="p">))))</span><span class="w">
  </span><span class="n">I_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">I_hi</span><span class="o">-</span><span class="n">I_lo</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BP_hi</span><span class="o">-</span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">C_p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">BP_lo</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I_lo</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">I_p</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">PM10_C12</span><span class="o">&lt;-</span><span class="n">C12_cal</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">PM10</span><span class="p">)</span><span class="w">
</span><span class="n">PM10_C_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PM_cal</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">PM10</span><span class="p">,</span><span class="m">70</span><span class="p">,</span><span class="n">PM10_C12</span><span class="p">)</span><span class="w">

</span><span class="n">PM2.5_C12</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">C12_cal</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">PM2.5</span><span class="p">)</span><span class="w">
</span><span class="n">PM2.5_C_p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PM_cal</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">PM2.5</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="n">PM2.5_C12</span><span class="p">)</span><span class="w">

</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">bind_cols</span><span class="p">(</span><span class="s2">"SO2_I_p"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SO2_I_p</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">SO2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">bind_cols</span><span class="p">(</span><span class="s2">"CO_I_p"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CO_I_p</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">CO</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">bind_cols</span><span class="p">(</span><span class="s2">"O3_I_p"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">O3_I_p</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">O3</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">bind_cols</span><span class="p">(</span><span class="s2">"NO2_I_p"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NO2_I_p</span><span class="p">(</span><span class="n">data</span><span class="o">$</span><span class="n">NO2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">bind_cols</span><span class="p">(</span><span class="s2">"PM10_I_p"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PM10_I_p</span><span class="p">(</span><span class="n">PM10_C_p</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">bind_cols</span><span class="p">(</span><span class="s2">"PM2.5_I_p"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PM2.5_I_p</span><span class="p">(</span><span class="n">PM2.5_C_p</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CAI_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">ends_with</span><span class="p">(</span><span class="s2">"I_p"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">BAD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rowSums</span><span class="p">(</span><span class="n">.</span><span class="w"> </span><span class="o">&gt;</span><span class="m">100</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">CAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">BAD</span><span class="o">&gt;=</span><span class="m">3</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">75</span><span class="p">,</span><span class="w"> </span><span class="n">BAD</span><span class="o">&gt;=</span><span class="m">2</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">CAI_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">CAI</span><span class="o">&gt;</span><span class="m">250</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">CAI</span><span class="o">&gt;</span><span class="m">100</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
                               </span><span class="n">CAI</span><span class="o">&gt;</span><span class="m">50</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"CAI"</span><span class="p">))</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">bind_cols</span><span class="p">(</span><span class="n">CAI_table</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">11</span><span class="o">:</span><span class="m">18</span><span class="p">)],</span><span class="m">5</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-python highlighter-rouge">
	<table>
	<thead><tr><th scope="col">SO2_I_p</th><th scope="col">CO_I_p</th><th scope="col">O3_I_p</th><th scope="col">NO2_I_p</th><th scope="col">PM10_I_p</th><th scope="col">PM2.5_I_p</th><th scope="col">CAI</th><th scope="col">CAI_index</th></tr></thead>
	<tbody>
		<tr><td>4.00     </td><td>7.5      </td><td>68.44068 </td><td>2.666667 </td><td>64.00000 </td><td> 88.71711</td><td> 88.71711</td><td>1        </td></tr>
		<tr><td>4.00     </td><td>7.5      </td><td>68.44068 </td><td>2.833333 </td><td>68.75000 </td><td>103.38782</td><td>103.38782</td><td>2        </td></tr>
		<tr><td>4.25     </td><td>7.5      </td><td>67.61017 </td><td>2.833333 </td><td>84.66667 </td><td>131.82942</td><td>131.82942</td><td>2        </td></tr>
		<tr><td>4.25     </td><td>7.5      </td><td>66.77966 </td><td>3.333333 </td><td>44.58333 </td><td> 66.44682</td><td> 66.77966</td><td>1        </td></tr>
		<tr><td>4.00     </td><td>7.5      </td><td>65.11864 </td><td>3.000000 </td><td>39.95833 </td><td> 64.79737</td><td> 65.11864</td><td>1        </td></tr>
	</tbody>
	</table>
</div>

<h2 id="32-timestep-wise-visualization">3.2. Timestep-wise Visualization</h2>
<ul>
  <li>시구간별 시각화 및 분석</li>
</ul>

<h3 id="321-hourly">3.2.1. Hourly</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 시간대(주간: 07~18, 야간: 19~06)에 따른 CAI 지수 분포</span><span class="w">
</span><span class="n">CAI_hourly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">time_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
    </span><span class="m">06</span><span class="o">&lt;</span><span class="n">hour</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">hour</span><span class="o">&lt;</span><span class="m">19</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"daytime"</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"nighttime"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">,</span><span class="n">day</span><span class="p">,</span><span class="n">time_tmp</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">mean_CAI</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">CAI</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">CAI_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">mean_CAI</span><span class="o">&gt;</span><span class="m">250</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">mean_CAI</span><span class="o">&gt;</span><span class="m">100</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
                             </span><span class="n">mean_CAI</span><span class="o">&gt;</span><span class="m">50</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># 해당 시간대의 평균 오염도</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w">
</span><span class="c1"># 시간에 따른 오염도의 분포는 거의 차이가 없음을 확인</span><span class="w">
</span><span class="n">CAI_hourly</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">time_tmp</span><span class="p">,</span><span class="n">CAI_idx</span><span class="p">)</span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">tally</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`summarise()` has grouped output by 'year', 'month', 'day'. You can override using the `.groups` argument.
</code></pre></div></div>

<div class="language-python highlighter-rouge">
	<table>
	<thead><tr><th scope="col">time_tmp</th><th scope="col">CAI_idx</th><th scope="col">n</th></tr></thead>
	<tbody>
		<tr><td>daytime  </td><td>0        </td><td>100      </td></tr>
		<tr><td>daytime  </td><td>1        </td><td>886      </td></tr>
		<tr><td>daytime  </td><td>2        </td><td> 93      </td></tr>
		<tr><td>daytime  </td><td>3        </td><td> 17      </td></tr>
		<tr><td>nighttime</td><td>0        </td><td> 73      </td></tr>
		<tr><td>nighttime</td><td>1        </td><td>895      </td></tr>
		<tr><td>nighttime</td><td>2        </td><td>115      </td></tr>
		<tr><td>nighttime</td><td>3        </td><td> 13      </td></tr>
	</tbody>
	</table>
</div>

<h3 id="322-daily">3.2.2. Daily</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### 일단위: 일평균 CAI 지수의 분포</span><span class="w">
</span><span class="n">CAI_daily</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">,</span><span class="n">day</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise_at</span><span class="p">(</span><span class="n">.vars</span><span class="o">=</span><span class="s2">"CAI"</span><span class="p">,</span><span class="w"> </span><span class="n">.funs</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">CAI_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">CAI</span><span class="o">&gt;</span><span class="m">250</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">CAI</span><span class="o">&gt;</span><span class="m">100</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
                             </span><span class="n">CAI</span><span class="o">&gt;</span><span class="m">50</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">CAI_daily</span><span class="o">$</span><span class="n">CAI_idx</span><span class="p">))</span><span class="w">
</span><span class="c1"># 평균 수준보다 오염도가 높은 날들은 연중 특정 시기에 집중되어있음</span><span class="w">
</span><span class="n">CAI_daily</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">unite</span><span class="p">(</span><span class="s2">"date"</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">"/"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate_at</span><span class="p">(</span><span class="s2">"date"</span><span class="p">,</span><span class="n">as.Date</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">date</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">CAI</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/images/output_19_1.png" alt="png" /></p>

<h3 id="323-montly">3.2.3. Montly</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### 월단위: 오염 수준 나쁨 이상인 "일수" 확인</span><span class="w">
</span><span class="n">CAI_monthly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CAI_daily</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">,</span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">mean_CAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">CAI</span><span class="p">),</span><span class="n">sum_CAI_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">CAI_idx</span><span class="o">&gt;</span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">m_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="n">month</span><span class="o">&lt;</span><span class="m">10</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"0"</span><span class="p">,</span><span class="nf">as.character</span><span class="p">(</span><span class="n">month</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s2">""</span><span class="p">),</span><span class="w">
                           </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">month</span><span class="p">))))</span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">y_tmp</span><span class="o">=</span><span class="nf">as.character</span><span class="p">(</span><span class="n">year</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">unite</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">y_tmp</span><span class="p">,</span><span class="n">m_tmp</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w">
</span><span class="c1"># 6월~9월은 장마 영향으로 추정. 겨울~봄에 집중적.</span><span class="w">
</span><span class="n">CAI_monthly</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_col</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">date</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sum_CAI_idx</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`summarise()` has grouped output by 'year'. You can override using the `.groups` argument.
</code></pre></div></div>

<p><img src="/assets/images/output_21_1.png" alt="png" /></p>

<h3 id="324-quarterly">3.2.4. Quarterly</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### 분기 단위</span><span class="w">
</span><span class="n">CAI_qtr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CAI_monthly</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">qtr_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
    </span><span class="n">month</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Q1"</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Q2"</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Q3"</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Q4"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">y_tmp</span><span class="o">=</span><span class="nf">as.character</span><span class="p">(</span><span class="n">year</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">unite</span><span class="p">(</span><span class="n">Qtr</span><span class="p">,</span><span class="w"> </span><span class="n">y_tmp</span><span class="p">,</span><span class="w"> </span><span class="n">qtr_tmp</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s2">"-"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">Qtr</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">mean_CAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">mean_CAI</span><span class="p">),</span><span class="w"> </span><span class="n">sum_CAI_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">sum_CAI_idx</span><span class="p">))</span><span class="w">
</span><span class="n">CAI_qtr</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_col</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Qtr</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sum_CAI_idx</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/images/output_23_0.png" alt="png" /></p>

<h3 id="325-half-yearly">3.2.5. Half-yearly</h3>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### 반기 단위: 2019년 상반기가 매우 심한 것이었음을 알 수 있음</span><span class="w">
</span><span class="n">CAI_half</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">CAI_monthly</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">transform</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">date</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
    </span><span class="n">date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">201801</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"2017_H2"</span><span class="p">,</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">201807</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"2018-H1"</span><span class="p">,</span><span class="w">
    </span><span class="n">date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">201901</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"2018_H2"</span><span class="p">,</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">201907</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"2019-H1"</span><span class="p">,</span><span class="w">
    </span><span class="n">date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">202001</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"2019-H2"</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"2020-H1"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">mean_CAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">mean_CAI</span><span class="p">),</span><span class="w"> </span><span class="n">sum_CAI_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">sum_CAI_idx</span><span class="p">))</span><span class="w">
</span><span class="n">CAI_half</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_col</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">year</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sum_CAI_idx</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="/assets/images/output_25_0.png" alt="png" /></p>

<h1 id="4-summary">4. Summary</h1>
<p>대기오염도는 대체적으로 여름보다 겨울에 높았고, 2019년이 특히 심했다는 것을 알 수 있다. 2020년을 기준으로 비교했을 때, 코로나의 영향은 거의 없었던 것으로 추정된다.</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
	<!--
            
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to Darron's Devlog</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
                </section>
            
	-->
            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            var this_page_url = 'http://0.0.0.0:4000/ds_R_final';
                            var this_page_identifier = '/ds_R_final';
                            var this_page_title = 'Data Science and R - Final';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            


        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/built/images/blog-cover1.png)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; Darron's Devlog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/projects/">Projects</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/fashion_GNN">Fashion GNN</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/DM_final">Data Mining - Final</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/AppML_Assginment1">AppML - Assignment1</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/projects/">
                                
                                    See all 5 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template no-image">
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/AppML_Assginment1">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Projects</span>
                            
                        
                    

                    <h2 class="post-card-title">AppML - Assignment1</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>2021-1. Applied Machine Learning

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                <span class="reading-time">
                    
                    
                      6 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template no-image">
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/NLP_final">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Projects</span>
                            
                        
                    

                    <h2 class="post-card-title">NLP - Final</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>2020-1. NLP

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                <span class="reading-time">
                    
                    
                      6 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="/">
            
            <span>Darron's Devlog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Data Science and R - Final</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Data+Science+and+R+-+Final&amp;url=https://12kdh43.github.io/ds_R_final"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://12kdh43.github.io/ds_R_final"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">Darron's Devlog</a> &copy; 2021</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Search Darron's Devlog</h1>
                <p class="subscribe-overlay-description">
				lunr.js를 이용한 posts 검색 </p>
                <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');

 </script>

	
    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
